## Classical preparations

In chapter \ref{chap:pam-classical}, I will present several novel results on the problem of certifying whether the behaviors of a given set of quantum preparations could also be achieved by preparing and measuring classical systems. To make that discussion precise and illustrate its importance, we must begin by defining what it is that we will call classically-simulatable behaviors or, for shortness, \emph{classical behaviors}.

Starting from the paradigmatic prepare-and-measure scenario, let us further impose that $\mathcal{S}$, the set of possible preparations, contains only \emph{classical states}. Naturally, as this is a communication scenario, the dimension $\abs{\mathcal{S}}$ of the classical system used for encoding the states must be bounded, otherwise communication becomes trivial and all behaviors are possible.

Our first aim is to investigate the set of behaviors that can be achieved when communicating $d$-dimensional classical systems (\emph{d}its), or rather, when  $\mathcal{S} = \natrange{d}$. They will, in general, also depend on $X$ and $Y$. Letting that set be $\mathcal{C}_{d,X,Y}$, our previous discussion implies that

$$
\mathbf{p} \in \mathcal{C}_{d,X,Y} \quad\Longleftrightarrow \quad \condprob{b}{x,y} = \sum_{m = 1}^{d} \condprob{m}{x} \condprob{b}{m,y} \quad\forall b,x,y .
\label{eq:pam-classical-independent}
$$


Essentially, then, $\mathcal{C}_{d,X,Y}$ contains all behaviors that preparation and measurement devices may generate when (i) the devices are \emph{uncorrelated}, (ii) the preparations are classical, (iii) they have at most dimension $d$, (iv) Alice has $X$ preparation choices, and (v) Bob picks one out of $Y$ measurement settings. To simplify the notation, whenever $X$ and $Y$ are arbitrary (but fixed) or clear by context, the subscripts will be omitted.

Briefly detouring, it is interesting to notice that model~\eqref{eq:pam-classical-independent} is very much in the spirit of ontological models \cite{Phys.Rev.A.71.052108,https://arxiv.org/pdf/0709.4266.pdf,https://arxiv.org/pdf/0709.1149,Phys.Rev.A.80,022106}. To see that, consider $\mathcal{S}$ as a finite, dimension-bounded ontic state space, and $x$ as the preparation procedure. Then, $\condprob{m}{x}$ models our associated epistemic state. Similarly, if we associate $y$ as a choice of measurement procedure, we may interpret $\condprob{b}{m,y}$ as the indicator function. In this way, any theory that only produces behaviors $\mathbf{p} \in \mathcal{C}_{d,X,Y}$ admits a dimension-bounded ontological model.
- Conditions (iii)--(iv) above are pretty much natural for any communication scenario, but the case is different for (i) and (ii). While in many situations, such as when we have some trust on our devices, condition (i) is justifiable, it is not always safe to assume that the devices are uncorrelated. The worst-case scenario for classical variables is when P and M can share an unbounded amount of pre-established correlations. Such correlations must reside in the causal past of the experiment (fig. \ref{pam-classical-sr}), but even so, they can be used to achieve better performance in several communication protocols implemented in the PM scenario \cite{devicente}, and lead to quite different geometrical structures \cite{devicente2,dallarno}. Without knowledge on what information they share, the best we can do is to call it $\lambda$ and say that $\pi$ is some probability distribution over this random variable. As both devices can fully access $\lambda \in \Lambda$,

$$
\mathbf{p} \in \mathcal{C}_{d,X,Y}^\lambda \quad\Longleftrightarrow \quad \condprob{b}{x,y} = \int_{\Lambda} \sum_{m = 1}^{d} \pi(\lambda) \condprob{m}{x,\lambda} \condprob{b}{m,y,\lambda} d\lambda \quad\forall b,x,y .
\label{eq:pam-classical-sr}
$$

Here, $\mathcal{C}_{d,X,Y}^\lambda$ is the set of behaviors we get from $\mathcal{C}_{d,X,Y}$ by allowing for shared randomness. As $\pi(\lambda) \geq 0$ and $\sum_\lambda \pi(\lambda) = 1$, eq.~\eqref{eq:pam-classical-sr} is actually telling us that $\mathcal{C}_{d,X,Y}^\lambda = \conv{\mathcal{C}_{d,X,Y}}$. More than that, a slight variation on Fine's theorem \cite{} (or sec. ? of \cite{valerio} for a more pedagogical discussion) can show that the set $\mathcal{C}_{d,X,Y}$ has a finite amount of extremal points, called deterministic strategies \cite{gallego,vicente}. They are the points given by eq.~\eqref{eq:pam-classical-independent} when the response functions are deterministic, i.e., when $\condprob{m}{x} = \delta_{m,f(x)}$ and $ \condprob{b}{m,y} = \delta_{b,g(m,y)}$, for some functions $f : \mathcal{X} \rightarrow [d]$ and $g : [d] \times \mathcal{Y} \rightarrow \mathcal{B}$ that are made precise in the aforementioned references. Whenever the sets in questions are finite, the number of extremal strategies is also finite. As $\mathcal{C}_{d,X,Y}^\lambda$ can now be seen as a convex hull of finitely many points, this proves that $\mathcal{C}_{d,X,Y}^\lambda$ is a polytope. Recalling the discussion in sec. \ref{sec:convexity-and-polytopes}, we emphasize that $\mathcal{C}_{d,X,Y}^\lambda$ can thus be described by an intersection of half-spaces, which are given by the linear inequalities defining its facets. This description will turn out to be especially useful in chap. \ref{chap-pam-classical}. In there, we will get back to this topic and work out an example that should clarify this discussion.

For an example of the usefulness in understanding these sets, notice that for some fixed $X$ and $Y$ and $d^\prime > d$, we have the proper inclusion $\mathcal{C}_{d} \subset \mathcal{C}_{d^\prime}$, which implies the same for the SR case. Ultimately, this means that larger dimensional communication can carry strictly more information. Now suppose that $W_d$ is a linear functional defining some facet of $\mathcal{C}_{d}^\lambda$ which is not a facet of $\mathcal{C}_{d^\prime}^\lambda$ (at least one such $W_d$ must exist since $\mathcal{C}_{d}^\lambda \subset \mathcal{C}_{d^\prime}^\lambda$) and that, for any behavior $\mathbf{p} \in \mathcal{C}_d^\lambda$, we have a bound $W_d \cdot \mathbf{p} \leq C_d$. Because $W_d$ does not define a facet of $\mathcal{C}_{d^\prime}^\lambda$, there is some $\mathbf{p}^\prime \in \mathcal{C}_{d^\prime}^\lambda$ such that $W_d \cdot \mathbf{p}^\prime > C_d$. Hence, if we are given preparation and measurement boxes which are guaranteed to prepare only classical systems, and we observe some behavior that, like $\mathbf{p}^\prime$, violates the bound on $W_d$, we can certify that there are preparations of dimension at least $d+1$.

In disguise, I have exemplified what is called a (dimension) witness: any functional and bound that, (i) for some set of behaviors is never violated, but that (ii) can be violated by at least one behavior of some other set is said to \emph{witness} some property. In our case, we are witnessing dimension in a semi device-independent fashion, as we have assumed the preparations are classical. Lastly, notice that the facets defining any $\mathcal{C}_d^\lambda$ are, by definition, dimension witnesses. Furthermore, they are \emph{tight} witnesses, something which not all witnesses must be.

For completeness, I note it is also possible to define a $\mathcal{C}_d^{\rho}$ set where the preparations remain classical, but the devices can be correlated through a shared quantum state $\rho$ \cite{tavakoli-ea,poderini}. When $\rho$ is an entangled state, it can lead to interesting behaviors associated with advantages in communication protocols \cite{earacs}.

